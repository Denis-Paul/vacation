<div class="container">
    <h1>Welcome to vacation planning application</h1>
    <p>You can find your next vacation destination here!</p>

    <% if user_signed_in? %>
        <p>Logged in as: <b> <%= current_user.email %> </b> </p>
        <br>
        <h3>Available destinations</h3>

        <table class="table">
            <thead class="thead-dark">
                <tr>
                    <th scope="col">City</th>
                    <th scope="col">Country</th>
                    <th scope="col">Currency</th>
                    <th scope="col">Current Weather</th>
                </tr>
            </thead>
            <tbody>
                <% @destinations.each do |destination| %>
                <tr>
                    <td><%= destination.city %></td>
                    <td><%= destination.country %></td>
                    <td><%= destination.currency %></td>
                    <% if WeatherApiService.call(destination.city) %>
                        <td>Temperature: <%= WeatherApiService.call(destination.city)[:temp_c] %> Â°C</td>
                        <td>Condition: <%= WeatherApiService.call(destination.city)[:condition][:text] %></td>
                    <% else %>
                        <td> No data available for this city </td>
                    <% end %>
                </tr>
                <% end %>
            </tbody>
        </table>

        <br>
        <%= link_to 'Sign Out', destroy_user_session_path, method: :delete %>
        <br>

    <% else %>
        <p>Please sign in to get the best of our application</p>
        <%= link_to 'Sign In', new_user_session_path %>
    <% end %>
</div>
